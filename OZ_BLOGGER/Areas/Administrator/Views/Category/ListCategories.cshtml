@{
    ViewBag.Title = "ListCategories";
    Layout = "~/Areas/Administrator/Views/Shared/AdminLayout.cshtml";
}

@using OZ_BLOGGER.Models.Entity;
@model List<Category>

<script src="~/Areas/Administrator/Assets/scripts/jquery.js"></script>

<!--- update-modal --->
<div id="updateModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="gridSystemModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">Update Category</h4>
            </div>
            @using (Html.BeginForm("Update", "Category", FormMethod.Post))
            {
                <div class="modal-body">
                    <input type="text" class="form-control" id="txtCategoryName" name="txtCategoryName" />
                    <input type="hidden" id="hdnCategoryId" name="hdnCategoryId" />
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <input type="submit" class="btn btn-primary" value="Udpate">
                </div>
            }
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!------------------------>

<!----- delete-modal ------>
<div id="deleteModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="gridSystemModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">Delete Category</h4>
            </div>
            <div class="modal-body">
                Do You Confirm Deletion?
            </div>
            <div class="modal-footer">
                @using (Html.BeginForm("HardDelete", "Category", FormMethod.Post))
                {
                    <input type="hidden" id="hdnDeletedId" name="hdnDeletedId" />
                    <input type="submit" value="Yes" class="btn btn-primary pull-right" />
                }
                <button type="button" class="btn btn-default pull-right" data-dismiss="modal" style="margin-right: 5px;">No</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!------------------------>

<!----- add-modal ------>
<div id="addModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="gridSystemModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">Add Category</h4>
            </div>
            @using (Html.BeginForm("Add", "Category", FormMethod.Post))
            {
                <div class="modal-body">
                    <input type="text" class="form-control" id="txtAddCategoryName" name="txtAddCategoryName" />
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <input type="submit" class="btn btn-primary" value="Save">
                </div>
            }
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!------------------------>

<!-- category-listing -->
<div class="row col-lg-12">
    <h2>Category Operations</h2>
</div>
<!-- active-categories -->
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading" style="display: flex; flex-direction: row; justify-content: space-between; align-items: center;">
                <div>Active Categories</div>
                <span data-toggle="modal" data-target="#addModal" class="btn btn-primary pull-right">Add Category</span>
            </div>
            <!-- /.panel-header -->
            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Category Name</th>
                                <th>Blog Count</th>
                                <th>Operations</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                int index = 1;
                                foreach (Category item in Model.Where(x => x.isActive == true))
                                {
                                <tr>
                                    <td>@index</td>
                                    <td>@item.CategoryName</td>
                                    <td>@item.BlogsOfCategory.Count</td>
                                    <td>
                                        <button class="btn btn-success" data-toggle="modal" data-target="#updateModal" 
                                            data-categoryId="@item.CategoryId" data-categoryName="@item.CategoryName">
                                            Update</button>
                                        @Html.ActionLink("Pacify", "Pacify", "Category",
                                        new { @Id = @item.CategoryId }, new { @class = "btn btn-warning" })
                                    </td>
                                </tr>
                                    index += 1;
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- /.panel-body -->
        </div>
        <!-- /.panel -->
    </div>
</div>
<!-- passive-categories -->
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                Passive Categories
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Category Name</th>
                                <th>Blog Count</th>
                                <th>Operations</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model.Where(x => x.isActive == false).Count() > 0)
                            {
                                foreach (Category item in Model.Where(x => x.isActive == false))
                                {
                                <tr>
                                    <td>@item.CategoryId</td>
                                    <td>@item.CategoryName</td>
                                    <td>@item.BlogsOfCategory.Count</td>
                                    <td>
                                        @Html.ActionLink("Activate", "Activate", "Category",
                                        new { @Id = @item.CategoryId }, new { @class = "btn btn-warning" })
                                        <button id="deletedId" data-toggle="modal" data-target="#deleteModal" 
                                            class="btn btn-danger" data-deletedId="@item.CategoryId">
                                            Delete</button>
                                    </td>
                                </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td>No Record</td>
                                    <td>No Record</td>
                                    <td>No Record</td>
                                    <td>No Record</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- /.panel-body -->
        </div>
        <!-- /.panel -->
    </div>
</div>
<!------------------------>

<!----- Script Area ------>
<script type="text/javascript">
    $("button").on('click', function () {
        var categoryName = $(this).attr("data-categoryName");
        var categoryId = $(this).attr("data-categoryId");
        $("#txtCategoryName").val(categoryName);
        $("#hdnCategoryId").val(categoryId);
    })

    $("button#deletedId").on('click', function () {
        var deletedId = $(this).attr("data-deletedId");
        $("#hdnDeletedId").val(deletedId);
    })
</script>
<!------------------------>
